<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>linechart</title>
    <style>
      * {
        padding: 0;
        margin: 0;
      }
      #chartdiv {
        width: 98%;
        height: 250px;
        border: 1px solid #ccc;
        padding: 0;
        margin: 10px;
      }
    </style>
  </head>
  <body>
    <div id="chartdiv"></div>

    <script src="../lib/core.js"></script>
    <script src="../lib/charts.js"></script>
    <script src="../lib/animated.js"></script>

    <script>
      am4core.useTheme(am4themes_animated);

      const chart = am4core.create("chartdiv", am4charts.XYChart);
      const categoryAxis = chart.yAxes.push(new am4charts.CategoryAxis());
      const valueAxis = chart.xAxes.push(new am4charts.ValueAxis());

      chart.padding(24, 32, 24, 32);

      // 데이터 추가
      chart.data = [
        { category: "전기 전자", value: 45 },
        { category: "미분류", value: 35 },
        { category: "금융업", value: 25 },
        { category: "운수 장비", value: 15 },
        { category: "서비스업", value: 5 },
      ];

      categoryAxis.dataFields.category = "category";
      categoryAxis.renderer.inversed = true;
      categoryAxis.renderer.grid.template.stroke = am4core.color("#E6EAF1");
      categoryAxis.renderer.grid.template.strokeOpacity = 1;
      categoryAxis.renderer.grid.template.disabled = true;

      categoryAxis.renderer.labels.template.fill = am4core.color("#232433");
      categoryAxis.renderer.labels.template.fontSize = 16;

      categoryAxis.renderer.cellStartLocation = 0; // 막대 높이 조절(start %)
      categoryAxis.renderer.cellEndLocation = 1; // 막대 높이 조절(end %)
      categoryAxis.renderer.minGridDistance = 10; // 간격조절

      // x축 하단
      valueAxis.min = 0;
      valueAxis.max = 50;

      valueAxis.strictMinMax = true;
      valueAxis.renderer.minGridDistance = 70; // 날짜 레이블 간격 조정
      valueAxis.renderer.grid.template.disabled = true;
      valueAxis.renderer.grid.template.strokeOpacity = 0;
      valueAxis.renderer.labels.template.fill = am4core.color("#71747C");
      valueAxis.renderer.labels.template.fontSize = 12;

      // x축 하단 세로바
      valueAxis.renderer.ticks.template.disabled = false;
      valueAxis.renderer.ticks.template.strokeOpacity = 1;
      valueAxis.renderer.ticks.template.stroke = am4core.color("#D4D8E2");
      valueAxis.renderer.ticks.template.strokeWidth = 1;
      valueAxis.renderer.ticks.template.length = 8;

      valueAxis.renderer.line.strokeOpacity = 1;
      valueAxis.renderer.line.strokeWidth = 1;
      valueAxis.renderer.line.stroke = am4core.color("#D4D8E2");

      // 회색바
      const rangeSeries = chart.series.push(new am4charts.ColumnSeries());
      rangeSeries.dataFields.valueX = "maxValue";
      rangeSeries.dataFields.categoryY = "category";
      rangeSeries.columns.template.fill = am4core.color("#F2F4F6");
      rangeSeries.columns.template.stroke = am4core.color("#F2F4F6");

      chart.data.forEach(function (item) {
        item.maxValue = 50;
      });
      rangeSeries.columns.template.column.cornerRadius(2, 2, 2, 2); // 모서리 둥글게 조절

      // 회색바 중앙정렬
      rangeSeries.columns.template.adapter.add("dy", function (dy, target) {
        if (target.dataItem) {
          const columnHeight = target.dataItem.column.height;
          const halfHeight = columnHeight / 2;
          return dy + halfHeight;
        }
        return dy;
      });

      // 블루
      const series = chart.series.push(new am4charts.ColumnSeries());
      series.dataFields.valueX = "value";
      series.dataFields.categoryY = "category";
      series.columns.template.fill = am4core.color("#006AF9");
      series.columns.template.stroke = am4core.color("#006AF9");
      series.columns.template.column.cornerRadius(2, 2, 2, 2); // 모서리 둥글게 조절

      // 블루바 중앙정렬
      series.columns.template.adapter.add("dy", function (dy, target) {
        if (target.dataItem) {
          const columnHeight = target.dataItem.column.height;
          const halfHeight = columnHeight / 2;
          return dy - halfHeight - 3;
        }
        return dy;
      });
    </script>
  </body>
</html>
